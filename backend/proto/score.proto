syntax = "proto3";

package score;

option go_package = "score-splitter/backend/gen/go/score;score";

service ScoreService {
  rpc UploadScore(UploadScoreRequest) returns (UploadScoreResponse);
  rpc TrimScore(TrimScoreRequest) returns (TrimScoreResponse);
  rpc SearchYoutubeVideos(SearchYoutubeVideosRequest) returns (SearchYoutubeVideosResponse);
}

message UploadScoreRequest {
  string title = 1;      // スコアのタイトル
  bytes pdf_file = 2;    // PDFファイル本体
}

message UploadScoreResponse {
  string message = 1;    // 結果メッセージ
  string score_id = 2;   // 保存したスコアのIDなど
}

message CropArea {
  double top = 1;        // 上端の開始位置 (0.0 - 1.0)
  double left = 2;       // 左端の開始位置 (0.0 - 1.0)
  double width = 3;      // 幅 (0.0 - 1.0)
  double height = 4;     // 高さ (0.0 - 1.0)
}

message PageTrimSetting {
  int32 page_number = 1;         // 対象ページ番号 (1始まり)
  repeated CropArea areas = 2;   // ページごとのトリミングエリア
}

message TrimScoreRequest {
  string title = 1;             // 生成するPDFのベース名
  bytes pdf_file = 2;           // 元のPDF
  repeated CropArea areas = 3;  // トリミングエリア
  string password = 4;          // PDFのパスワード（必要な場合）
  repeated int32 include_pages = 5; // トリミング対象に含めるページ番号（1始まり）
  repeated PageTrimSetting page_settings = 6; // ページごとのトリミング設定
}

message TrimScoreResponse {
  string message = 1;       // 結果メッセージ
  bytes trimmed_pdf = 2;    // 生成したPDF
  string filename = 3;      // 推奨ファイル名
}

message SearchYoutubeVideosRequest {
  string query = 1; // 検索キーワード
}

message YoutubeVideo {
  string video_id = 1;
  string title = 2;
  string thumbnail_url = 3;
}

message SearchYoutubeVideosResponse {
  repeated YoutubeVideo videos = 1;
}
